from airflow import DAG
from airflow.operators.http_operator import SimpleHttpOperator
from airflow.sensors.http_sensor import HttpSensor
from airflow.utils.dates import days_ago
from datetime import timedelta
import json

dag = DAG(
    "{{dag_id}}",
    schedule_interval="{{schedule_interval}}",
    start_date=days_ago(1),
    catchup={{catchup or False}},
)

# Define the HTTP operator
http_task = SimpleHttpOperator(
    task_id='http_task',
    http_conn_id='your_http_connection',  # Specify the HTTP connection ID
    endpoint='{{endpoint}}',  # Specify the endpoint to hit
    method='{{method}}',  # Specify the HTTP method
    headers={'Content-Type': 'application/json'}, # Add any headers if needed
    data=json.dumps({{info}}),  # Add any data if needed
    log_response=True,  # Log the response in the Airflow UI
    dag=dag,
)

# Set up task dependencies
http_task
